#-----------------------------------------------------------------------
#  1. データ読み込み & Y軸最大値の取得（背景ストライプ計算のため）
#-----------------------------------------------------------------------
set datafile separator ","     # 区切り文字の指定

set term dumb                  # 値のみ取得のため、いったん端末上に表示
set yrange [0:*]               # Y軸を0〜自動最大
plot 'bargraph.csv' using 1:2  # 1列目=ラベル, 2列目=値
YMAX = int(GPVAL_Y_MAX)        # 最大Y値を取得して整数化

#-----------------------------------------------------------------------
#  2. PNG出力設定
#-----------------------------------------------------------------------
set terminal pngcairo size 640,480 font "IPAPGothic,10.5"
set output "bargraph.png"

#-----------------------------------------------------------------------
#  3. 背景ストライプ作成（偶数行だけ灰色にする）
#-----------------------------------------------------------------------
do for [i=1:YMAX-1:2] {
    set object i+1 rect \
        from graph 0, first i  to graph 1, first (i+1) \
        fc rgb "#f8f8f8" fillstyle solid 1.0 noborder behind
}

#-----------------------------------------------------------------------
#  4. グラフ全体の設定（軸 / 目盛 / 枠線）
#-----------------------------------------------------------------------
set ytics 1                          # Y軸は1刻み
set xtics nomirror                   # 目盛の上側は消す
set ytics nomirror                   # 目盛の右側は消す
set tics textcolor rgb "#000000"     # 目盛文字の色

# 外枠（左と下だけ）
set border 3 lc rgb "#888888" lw 1

# タイトル（png画像全体の中央）
set tmargin 4
set label 200 "FreeBSDパソコン起動回数" at screen 0.5, screen 0.95 \
    center font ",16" tc rgb "#000000"

# Y軸単位ラベル（最上部の左）
set label 100 "（回）" at graph -0.01, graph 1.06 \
    right tc rgb "#000000"

#-----------------------------------------------------------------------
#  5. 棒グラフの見た目
#-----------------------------------------------------------------------
set style data histograms            # 棒グラフ
set style fill solid 1.0 border      # 塗りつぶし・枠
set boxwidth 0.5                     # 棒の太さ

#-----------------------------------------------------------------------
#  6. 描画
#-----------------------------------------------------------------------
plot "bargraph.csv" using 2:xtic(1) title "" with boxes fc rgb "#6195ca"
